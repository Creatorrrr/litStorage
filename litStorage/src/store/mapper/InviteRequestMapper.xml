<?xml version="1.0" encoding="UTF-8"?>

<!DOCTYPE mapper
  PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
  "http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="store.mapper.InviteRequestMapper">
	<resultMap type="InviteRequest" id="inviteRequestMap">
		<result property="message" column="message" />
		<result property="form" column="form" />
		<result property="sendTime" column="sendtime"/>
		
		<association property="sender" column="sender"
			select="store.mapper.MemberMapper.selectMemberById" javaType="Member"
			jdbcType="VARCHAR" />
		<association property="receiver" column="receiver"
			select="store.mapper.MemberMapper.selectMemberById" javaType="Member"
			jdbcType="VARCHAR" />
	</resultMap>
	<sql id="selectInviteRequest"> 
		SELECT sender, receiver, sendtime, form, message
		FROM
		inviterequest
	</sql>

	<select id="selectInviteRequestBySenderId" parameterType="string"
		resultMap="inviteRequestMap">
		<include refid="selectInviteRequest" />
		WHERE sender = #{sender}
	</select>
	<select id="selectInviteRequestByReceiverId" parameterType="string"
		resultMap="inviteRequestMap">
		<include refid="selectInviteRequest" />
		WHERE receiver = #{receiver}
	</select>

	<insert id="insertInviteRequest">
		INSERT INTO inviterequest(sender, receiver, sendTime, form,
		message)
		VALUES (#{sender.id},#{receiver.id},TO_DATE(sysdate,'yyyy/mm/dd hh24:mi:ss'),#{form},#{message})
	</insert>
	<delete id="deleteInviteRequest" parameterType="map">
		DELETE FROM
		inviterequest
		WHERE sender = #{sender} AND receiver = #{receiver}
	</delete>
</mapper>
  
  
